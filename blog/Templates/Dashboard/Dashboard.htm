{% extends 'Extensions/Base.htm' %}
{% block title %}
    Dashboard
{% endblock %}
{% block content %}
<style>
    .news{
        display: none;
    }
    .users{
        display: none;
    }
    .posts{
        display: inline;
    }
</style>
<script>
    function users(){
        document.querySelector(".posts").style.display = "none";
        document.querySelector(".users").style.display = "inline";
        document.querySelector(".news").style.display = "none";
    }
    function posts(){
        document.querySelector(".news").style.display = "none";
        document.querySelector(".posts").style.display = "inline";
        document.querySelector(".users").style.display = "none";
    }
    function news(){
        document.querySelector(".posts").style.display = "none";
        document.querySelector(".news").style.display = "inline";
        document.querySelector(".users").style.display = "none";
    }
</script>
    <div class="action table-responsive">
        <h5 class="card-header bg-dark text-light">
            Actions
        </h5>
        <table class="table table-dark">
            <thead>
                <tr>
                    <th scope="col">
                        <a href="/CreatingPost" class="text-decoration-none text-light">
                            Create Post
                        </a>
                    </th>
                    <script>
                        function newsletter(){
                            $.ajax({
                                url:"/SendingNewsletter",
                                success:function(data){
                                    if (data == 'sent') {
                                        alert("Latest Posts have been sent to subscribers");
                                    }else{
                                        alert("Sorry Try Again. If you already Tried and its not working. Message Developer");
                                    }
                                }
                            });
                        }
                    </script>
                    <th scope="col" onclick="newsletter()"> Send Newsletter</th>
                    <th scope="col" onclick="posts()">Manage Post</th>  
                    <th scope="col" onclick="users()">Manage User</th>
                    <th scope="col" onclick="news()">Newsletter Subscribers</th>
                </tr>
            </thead>
        </table>
    </div>
    <div class="news container">
        <div class="table-responsive">
            <form action="" class="nav-item mt-2">
                <div class="input-group">
                    <input type="search" class="form-control bg-dark text-light" placeholder="Search Newsletter User...">
                    <button class="btn btn-outline-secondary">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </form>
            <h5 class="card-header bg-dark text-light">
                Newsletter New User
            </h5>
            <table class="table table-dark table-striped">
                <thead>
                    <tr>
                        <th scope="col">Email</th>  
                        <th scope="col">Date Joined</th>
                    </tr>
                </thead>
                <tbody>
                    {% for news in news %}
                    <tr>
                        <td>{{news.email}}</td>
                        <td>{{news.timestamp}}</td>
                    </tr>
                        {% endfor %}
                </tbody>
            </table>
        </div>
    </div>    
    <div class="users container">
        <div class="table-responsive">
            <form action="" class="nav-item mt-2">
                <div class="input-group">
                    <input type="search" class="form-control bg-dark text-light" placeholder="Search User...">
                    <button class="btn btn-outline-secondary">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </form>
            <h5 class="card-header bg-dark text-light">
                Newly Registered User
            </h5>
            <table class="table table-dark">
                <thead>
                    <tr>
                        <th scope="col">Email</th>  
                        <th scope="col">Date Joined</th>  
                        <th scope="col">Last Seen</th>
                        <th scope="col">Superuser</th>
                        <th scope="col">Staff</th>
                    </tr>
                </thead>
                <tbody>
                    {% for users in users %}
                    <tr>
                        <td>{{users.email}}</td>
                            <td>{{users.date_joined}}</td>
                            <td>{{users.last_login|timesince}}</td>
                            {% if users.is_superuser == True %}
                            <td>
                                <i class="fa fa-check text-success"></i>
                            </td>
                            {% else %}
                            <td>
                                <i class="fa fa-check text-danger"></i>
                                </td>
                                {% endif %}
                            {% if users.is_staff == True %}
                                <td>
                                    <i class="fa fa-check text-success"></i>
                                </td>
                            {% else %}
                                <td>
                                    <i class="fa fa-check text-danger"></i>
                                </td>
                            {% endif %}
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
        </div>
    </div>    
    <div class="posts container">
        <div class="table-responsive">
            <form action="" class="nav-item mt-2">
                <div class="input-group">
                    <input type="search" class="form-control bg-dark text-light" placeholder="Search Post...">
                    <button class="btn btn-outline-secondary">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </form>
            <h5 class="card-header bg-dark text-light">
                All Posts
            </h5>
            <table class="table table-dark table-hover tabel-sm">
                <thead >
                    <tr>
                        <th scope="col">Title</th>  
                        <th scope="col">Short Description</th>
                        <th scope="col">Author</th>
                        <th scope="col"><i id="eye" class="fa fa-eye text-warning"></i></th>  
                        <th scope="col"><i id="like" class="fa fa-thumbs-up text-primary"></i></th>  
                        <th scope="col"><i id="hate" class="fa fa-thumbs-down text-info"></i></th>  
                        <th scope="col"><i id="love" class="fa fa-heart text-danger"></i></th>  
                        <th scope="col"><i id="comm" class="fa fa-comment text-secondary"></i></th>  
                        <th scope="col">Link</th>
                        <th><i class="fa fa-edit text-light"></i></th>
                        <th><i class="fa fa-trash text-danger"></i></th>
                    </tr>
                </thead>
                <tbody id="postviews">
                    {% for post in posts %}
                        <tr>
                            <td>{{post.title}}</td>
                            <td>{{post.sub}}</td>
                            <td>{{post.author}}</td>
                            <td>{{post.view.count}}</td>
                            <td>{{post.like.count}}</td>
                            <td>{{post.hate.count}}</td>
                            <td>{{post.love.count}}</td>
                            <td>{{post.commentss.count}}</td>
                            <td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td>
                            <td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td>
                            <td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td>
                        </tr>
                    {% empty %}
                       <tr>
                           <div class="text-center bg-dark text-light">
                                No Post Yet. <br>
                                <a href="/CreatingPost" class="text-decoration-none text-primary">
                                    Create Post
                                </a>
                            </div>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <script>
        $("#eye").on("click", function(){
            let posts = '{% for post in postview %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}'
            $("#postviews").html('');
            //document.getElementById("#postviews").value += post;
            //document.getElementById("#postviews").value = '';
            //alert('wow');
            $("#postviews").html('');
            $("#postviews").html(posts);
                
                //'{% for post in posts %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}')
        })
        $("#hate").on("click", function(){
            let post = '{% for post in posthate %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}'
            $("#postviews").html('');
            //document.getElementById("#postviews").value += post;
            //document.getElementById("#postviews").value = '';
            //alert('wow');
            $("#postviews").html('');
            $("#postviews").html(post);
                
                //'{% for post in posts %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}')
        })
        
        $("#love").on("click", function(){
            let post = '{% for post in postheart %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}'
            $("#postviews").html('');
            //document.getElementById("#postviews").value += post;
            //document.getElementById("#postviews").value = '';
            //alert('wow');
            $("#postviews").html('');
            $("#postviews").html(post);
                
                //'{% for post in posts %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}')
        })
        
        $("#like").on("click", function(){
            let post = '{% for post in postlike %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}'
            $("#postviews").html('');
            //document.getElementById("#postviews").value += post;
            //document.getElementById("#postviews").value = '';
            //alert('wow');
            $("#postviews").html('');
            $("#postviews").html(post);
                
                //'{% for post in posts %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}')
        })
        
        $("#comm").on("click", function(){
            let post = '{% for post in postcomment %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}'
            $("#postviews").html('');
            //document.getElementById("#postviews").value += post;
            //document.getElementById("#postviews").value = '';
            //alert('wow');
            $("#postviews").html('');
            $("#postviews").html(post);
                
                //'{% for post in posts %}<tr><td>{{post.title}}</td><td>{{post.sub}}</td><td>{{post.author}}</td><td>{{post.view.count}}</td><td>{{post.like.count}}</td><td>{{post.hate.count}}</td><td>{{post.love.count}}</td><td>{{post.commentss.count}}</td><td><a href="{% url 'post:viewpost' pk=post.pk name=post.title %}" class="text-decoration-none">ReadMore</a></td><td><a href="{% url 'dashboard:editpost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-edit"></i></a></td><td><a href="{% url 'dashboard:deletepost' pk=post.pk %}" class="text-decoration-none"><i class="fa fa-trash text-danger"></i></a></td></tr>{% endfor %}')
        })
    </script>
{% endblock %}